{"ast":null,"code":"import React from 'react';\nimport { Menu } from '../Menu';\nimport { Popup } from '../Popup';\nimport { useListNavigation } from '../utils/useListNavigation';\nimport { cnDropdownMenu } from './DropdownMenu.classname';\nimport { DropdownMenuContext } from './DropdownMenuContext';\nimport { DropdownMenuItem } from './DropdownMenuItem';\nimport { DropdownMenuNavigationContext } from './DropdownMenuNavigationContext';\nimport { isSeparator } from './utils/isSeparator';\nimport { shouldSkipItemNavigation } from './utils/shouldSkipItemNavigation';\nimport { stringifyNavigationPath } from './utils/stringifyNavigationPath';\nexport const DropdownMenuPopup = ({\n  items,\n  open,\n  anchorRef,\n  onClose,\n  size,\n  menuProps,\n  children,\n  popupProps,\n  path = []\n}) => {\n  const {\n    toggle,\n    data\n  } = React.useContext(DropdownMenuContext);\n  const {\n    activeMenuPath,\n    setActiveMenuPath,\n    anchorRef: navigationAnchorRef\n  } = React.useContext(DropdownMenuNavigationContext);\n  const isSubmenu = path.length > 0;\n  const activateParent = React.useCallback(() => {\n    setActiveMenuPath(path.slice(0, path.length - 1));\n  }, [setActiveMenuPath, path]);\n  const handleMouseEnter = React.useCallback(event => {\n    var _a;\n    setActiveMenuPath(path);\n    (_a = popupProps === null || popupProps === void 0 ? void 0 : popupProps.onMouseEnter) === null || _a === void 0 ? void 0 : _a.call(popupProps, event);\n  }, [path, popupProps, setActiveMenuPath]);\n  const handleMouseLeave = React.useCallback(event => {\n    var _a;\n    activateParent();\n    (_a = popupProps === null || popupProps === void 0 ? void 0 : popupProps.onMouseLeave) === null || _a === void 0 ? void 0 : _a.call(popupProps, event);\n  }, [activateParent, popupProps]);\n  const handleSelect = React.useCallback((activeItem, event) => {\n    var _a;\n    if (activeItem.items && activeItem.path) {\n      setActiveMenuPath(activeItem.path);\n    } else {\n      (_a = activeItem.action) === null || _a === void 0 ? void 0 : _a.call(activeItem, event, data);\n      toggle(false);\n    }\n  }, [data, setActiveMenuPath, toggle]);\n  const handleKeydown = React.useCallback((activeItemIndex, event) => {\n    switch (event.key) {\n      case 'Escape':\n        {\n          if (isSubmenu) {\n            event.stopPropagation();\n            activateParent === null || activateParent === void 0 ? void 0 : activateParent();\n          }\n          return false;\n        }\n      case 'Enter':\n      case ' ':\n        {\n          const activeItem = items[activeItemIndex];\n          if (activeItem) {\n            event.preventDefault();\n            handleSelect(activeItem, event);\n          }\n          return false;\n        }\n    }\n    return true;\n  }, [activateParent, handleSelect, isSubmenu, items]);\n  const isNavigationActive = open && stringifyNavigationPath(path) === stringifyNavigationPath(activeMenuPath);\n  const {\n    activeItemIndex,\n    setActiveItemIndex,\n    reset: resetNavigation\n  } = useListNavigation({\n    items,\n    skip: shouldSkipItemNavigation,\n    anchorRef: navigationAnchorRef,\n    onAnchorKeyDown: handleKeydown,\n    disabled: !isNavigationActive,\n    initialValue: isSubmenu ? 0 : -1\n  });\n  React.useEffect(() => {\n    if (!open) {\n      resetNavigation();\n    }\n  }, [open, resetNavigation]);\n  return React.createElement(Popup, Object.assign({\n    open: open,\n    anchorRef: anchorRef,\n    onClose: onClose\n  }, popupProps, {\n    onMouseEnter: handleMouseEnter,\n    onMouseLeave: handleMouseLeave\n  }), children || React.createElement(Menu, Object.assign({\n    className: cnDropdownMenu('menu'),\n    size: size\n  }, menuProps), items.map((item, index) => {\n    const isActive = isNavigationActive && activeItemIndex === index;\n    const activate = () => setActiveItemIndex(index);\n    const extraProps = Object.assign(Object.assign({}, item.extraProps), {\n      onMouseEnter: activate\n    });\n    return React.createElement(DropdownMenuItem, Object.assign({\n      key: index,\n      className: cnDropdownMenu('menu-item', {\n        separator: isSeparator(item)\n      }, item.className),\n      selected: isActive,\n      popupProps: popupProps,\n      closeMenu: onClose\n    }, item, {\n      extraProps: extraProps\n    }));\n  })));\n};","map":{"version":3,"names":["React","Menu","Popup","useListNavigation","cnDropdownMenu","DropdownMenuContext","DropdownMenuItem","DropdownMenuNavigationContext","isSeparator","shouldSkipItemNavigation","stringifyNavigationPath","DropdownMenuPopup","items","open","anchorRef","onClose","size","menuProps","children","popupProps","path","toggle","data","useContext","activeMenuPath","setActiveMenuPath","navigationAnchorRef","isSubmenu","length","activateParent","useCallback","slice","handleMouseEnter","event","_a","onMouseEnter","call","handleMouseLeave","onMouseLeave","handleSelect","activeItem","action","handleKeydown","activeItemIndex","key","stopPropagation","preventDefault","isNavigationActive","setActiveItemIndex","reset","resetNavigation","skip","onAnchorKeyDown","disabled","initialValue","useEffect","createElement","Object","assign","className","map","item","index","isActive","activate","extraProps","separator","selected","closeMenu"],"sources":["/Users/ilaulanov/node_modules/@gravity-ui/uikit/build/esm/components/DropdownMenu/DropdownMenuPopup.js"],"sourcesContent":["import React from 'react';\nimport { Menu } from '../Menu';\nimport { Popup } from '../Popup';\nimport { useListNavigation } from '../utils/useListNavigation';\nimport { cnDropdownMenu } from './DropdownMenu.classname';\nimport { DropdownMenuContext } from './DropdownMenuContext';\nimport { DropdownMenuItem } from './DropdownMenuItem';\nimport { DropdownMenuNavigationContext } from './DropdownMenuNavigationContext';\nimport { isSeparator } from './utils/isSeparator';\nimport { shouldSkipItemNavigation } from './utils/shouldSkipItemNavigation';\nimport { stringifyNavigationPath } from './utils/stringifyNavigationPath';\nexport const DropdownMenuPopup = ({ items, open, anchorRef, onClose, size, menuProps, children, popupProps, path = [], }) => {\n    const { toggle, data } = React.useContext(DropdownMenuContext);\n    const { activeMenuPath, setActiveMenuPath, anchorRef: navigationAnchorRef, } = React.useContext(DropdownMenuNavigationContext);\n    const isSubmenu = path.length > 0;\n    const activateParent = React.useCallback(() => {\n        setActiveMenuPath(path.slice(0, path.length - 1));\n    }, [setActiveMenuPath, path]);\n    const handleMouseEnter = React.useCallback((event) => {\n        var _a;\n        setActiveMenuPath(path);\n        (_a = popupProps === null || popupProps === void 0 ? void 0 : popupProps.onMouseEnter) === null || _a === void 0 ? void 0 : _a.call(popupProps, event);\n    }, [path, popupProps, setActiveMenuPath]);\n    const handleMouseLeave = React.useCallback((event) => {\n        var _a;\n        activateParent();\n        (_a = popupProps === null || popupProps === void 0 ? void 0 : popupProps.onMouseLeave) === null || _a === void 0 ? void 0 : _a.call(popupProps, event);\n    }, [activateParent, popupProps]);\n    const handleSelect = React.useCallback((activeItem, event) => {\n        var _a;\n        if (activeItem.items && activeItem.path) {\n            setActiveMenuPath(activeItem.path);\n        }\n        else {\n            (_a = activeItem.action) === null || _a === void 0 ? void 0 : _a.call(activeItem, event, data);\n            toggle(false);\n        }\n    }, [data, setActiveMenuPath, toggle]);\n    const handleKeydown = React.useCallback((activeItemIndex, event) => {\n        switch (event.key) {\n            case 'Escape': {\n                if (isSubmenu) {\n                    event.stopPropagation();\n                    activateParent === null || activateParent === void 0 ? void 0 : activateParent();\n                }\n                return false;\n            }\n            case 'Enter':\n            case ' ': {\n                const activeItem = items[activeItemIndex];\n                if (activeItem) {\n                    event.preventDefault();\n                    handleSelect(activeItem, event);\n                }\n                return false;\n            }\n        }\n        return true;\n    }, [activateParent, handleSelect, isSubmenu, items]);\n    const isNavigationActive = open && stringifyNavigationPath(path) === stringifyNavigationPath(activeMenuPath);\n    const { activeItemIndex, setActiveItemIndex, reset: resetNavigation, } = useListNavigation({\n        items,\n        skip: shouldSkipItemNavigation,\n        anchorRef: navigationAnchorRef,\n        onAnchorKeyDown: handleKeydown,\n        disabled: !isNavigationActive,\n        initialValue: isSubmenu ? 0 : -1,\n    });\n    React.useEffect(() => {\n        if (!open) {\n            resetNavigation();\n        }\n    }, [open, resetNavigation]);\n    return (React.createElement(Popup, Object.assign({ open: open, anchorRef: anchorRef, onClose: onClose }, popupProps, { onMouseEnter: handleMouseEnter, onMouseLeave: handleMouseLeave }), children || (React.createElement(Menu, Object.assign({ className: cnDropdownMenu('menu'), size: size }, menuProps), items.map((item, index) => {\n        const isActive = isNavigationActive && activeItemIndex === index;\n        const activate = () => setActiveItemIndex(index);\n        const extraProps = Object.assign(Object.assign({}, item.extraProps), { onMouseEnter: activate });\n        return (React.createElement(DropdownMenuItem, Object.assign({ key: index, className: cnDropdownMenu('menu-item', { separator: isSeparator(item) }, item.className), selected: isActive, popupProps: popupProps, closeMenu: onClose }, item, { extraProps: extraProps })));\n    })))));\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
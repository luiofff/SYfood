{"ast":null,"code":"import React from 'react';\nimport { isFocusable, isTabbable } from 'tabbable';\nexport function useRestoreFocus({\n  enabled,\n  restoreFocusRef,\n  focusTrapped\n}) {\n  const ref = React.useRef(null);\n  const initialActiveElementRef = React.useRef(null);\n  const lastActiveElementRef = React.useRef(null);\n  const handleFocus = event => {\n    var _a;\n    if (enabled && initialActiveElementRef.current === null) {\n      initialActiveElementRef.current = event.relatedTarget;\n      lastActiveElementRef.current = initialActiveElementRef.current;\n      ref.current = (_a = (restoreFocusRef === null || restoreFocusRef === void 0 ? void 0 : restoreFocusRef.current) || initialActiveElementRef.current) !== null && _a !== void 0 ? _a : null;\n    }\n  };\n  React.useEffect(() => {\n    if (!enabled) {\n      return undefined;\n    }\n    const handleFocusIn = event => {\n      const element = event.target;\n      if (!focusTrapped && element instanceof HTMLElement && isTabbable(element)) {\n        lastActiveElementRef.current = element;\n      }\n    };\n    const handlePointerDown = event => {\n      const element = event.target;\n      if (element instanceof HTMLElement && isTabbable(element)) {\n        lastActiveElementRef.current = element;\n      } else {\n        lastActiveElementRef.current = null;\n      }\n    };\n    window.addEventListener('focusin', handleFocusIn);\n    window.addEventListener('mousedown', handlePointerDown);\n    window.addEventListener('touchstart', handlePointerDown);\n    return () => {\n      window.removeEventListener('focusin', handleFocusIn);\n      window.removeEventListener('mousedown', handlePointerDown);\n      window.removeEventListener('touchstart', handlePointerDown);\n    };\n  }, [enabled, focusTrapped]);\n  React.useEffect(() => {\n    var _a;\n    if (enabled) {\n      ref.current = (_a = (restoreFocusRef === null || restoreFocusRef === void 0 ? void 0 : restoreFocusRef.current) || initialActiveElementRef.current) !== null && _a !== void 0 ? _a : null;\n    } else {\n      ref.current = null;\n    }\n  });\n  React.useEffect(() => {\n    if (!enabled) {\n      return undefined;\n    }\n    return () => {\n      let element = ref.current;\n      const lastActive = lastActiveElementRef.current;\n      if (lastActive && document.contains(lastActive) && isTabbable(lastActive)) {\n        element = lastActive;\n      }\n      if (element && typeof element.focus === 'function' && document.contains(element) && isFocusable(element)) {\n        if (element !== document.activeElement) {\n          setTimeout(() => {\n            element === null || element === void 0 ? void 0 : element.focus();\n          }, 0);\n        }\n        initialActiveElementRef.current = null;\n        lastActiveElementRef.current = null;\n      }\n    };\n  }, [enabled]);\n  return {\n    onFocus: handleFocus\n  };\n}","map":{"version":3,"names":["React","isFocusable","isTabbable","useRestoreFocus","enabled","restoreFocusRef","focusTrapped","ref","useRef","initialActiveElementRef","lastActiveElementRef","handleFocus","event","_a","current","relatedTarget","useEffect","undefined","handleFocusIn","element","target","HTMLElement","handlePointerDown","window","addEventListener","removeEventListener","lastActive","document","contains","focus","activeElement","setTimeout","onFocus"],"sources":["/Users/ilaulanov/Documents/SynopsisYard/SYfood/client/node_modules/@gravity-ui/uikit/build/esm/components/utils/useRestoreFocus.js"],"sourcesContent":["import React from 'react';\nimport { isFocusable, isTabbable } from 'tabbable';\nexport function useRestoreFocus({ enabled, restoreFocusRef, focusTrapped }) {\n    const ref = React.useRef(null);\n    const initialActiveElementRef = React.useRef(null);\n    const lastActiveElementRef = React.useRef(null);\n    const handleFocus = (event) => {\n        var _a;\n        if (enabled && initialActiveElementRef.current === null) {\n            initialActiveElementRef.current = event.relatedTarget;\n            lastActiveElementRef.current = initialActiveElementRef.current;\n            ref.current = (_a = ((restoreFocusRef === null || restoreFocusRef === void 0 ? void 0 : restoreFocusRef.current) || initialActiveElementRef.current)) !== null && _a !== void 0 ? _a : null;\n        }\n    };\n    React.useEffect(() => {\n        if (!enabled) {\n            return undefined;\n        }\n        const handleFocusIn = (event) => {\n            const element = event.target;\n            if (!focusTrapped && element instanceof HTMLElement && isTabbable(element)) {\n                lastActiveElementRef.current = element;\n            }\n        };\n        const handlePointerDown = (event) => {\n            const element = event.target;\n            if (element instanceof HTMLElement && isTabbable(element)) {\n                lastActiveElementRef.current = element;\n            }\n            else {\n                lastActiveElementRef.current = null;\n            }\n        };\n        window.addEventListener('focusin', handleFocusIn);\n        window.addEventListener('mousedown', handlePointerDown);\n        window.addEventListener('touchstart', handlePointerDown);\n        return () => {\n            window.removeEventListener('focusin', handleFocusIn);\n            window.removeEventListener('mousedown', handlePointerDown);\n            window.removeEventListener('touchstart', handlePointerDown);\n        };\n    }, [enabled, focusTrapped]);\n    React.useEffect(() => {\n        var _a;\n        if (enabled) {\n            ref.current = (_a = ((restoreFocusRef === null || restoreFocusRef === void 0 ? void 0 : restoreFocusRef.current) || initialActiveElementRef.current)) !== null && _a !== void 0 ? _a : null;\n        }\n        else {\n            ref.current = null;\n        }\n    });\n    React.useEffect(() => {\n        if (!enabled) {\n            return undefined;\n        }\n        return () => {\n            let element = ref.current;\n            const lastActive = lastActiveElementRef.current;\n            if (lastActive && document.contains(lastActive) && isTabbable(lastActive)) {\n                element = lastActive;\n            }\n            if (element &&\n                typeof element.focus === 'function' &&\n                document.contains(element) &&\n                isFocusable(element)) {\n                if (element !== document.activeElement) {\n                    setTimeout(() => {\n                        element === null || element === void 0 ? void 0 : element.focus();\n                    }, 0);\n                }\n                initialActiveElementRef.current = null;\n                lastActiveElementRef.current = null;\n            }\n        };\n    }, [enabled]);\n    return { onFocus: handleFocus };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
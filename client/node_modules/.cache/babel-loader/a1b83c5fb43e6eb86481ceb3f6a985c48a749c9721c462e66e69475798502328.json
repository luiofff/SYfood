{"ast":null,"code":"import React from 'react';\nimport { createFocusTrap } from 'focus-trap';\nimport { useForkRef, useUniqId } from '../../hooks';\nconst focusTrapContext = React.createContext(undefined);\nexport function FocusTrap({\n  children,\n  enabled = true,\n  disableAutoFocus,\n  autoFocus = true\n}) {\n  const nodeRef = React.useRef(null);\n  const setAutoFocusRef = React.useRef(!disableAutoFocus && autoFocus);\n  React.useEffect(() => {\n    setAutoFocusRef.current = !disableAutoFocus && autoFocus;\n  });\n  const focusTrapRef = React.useRef();\n  const containersRef = React.useRef({});\n  const updateContainerElements = React.useCallback(() => {\n    var _a;\n    (_a = focusTrapRef.current) === null || _a === void 0 ? void 0 : _a.updateContainerElements([nodeRef.current, ...Object.values(containersRef.current)]);\n  }, []);\n  const actions = React.useMemo(() => ({\n    addNode(id, node) {\n      var _a;\n      if (containersRef.current[id] !== node && !((_a = nodeRef.current) === null || _a === void 0 ? void 0 : _a.contains(node))) {\n        containersRef.current[id] = node;\n        updateContainerElements();\n      }\n    },\n    removeNode(id) {\n      if (containersRef.current[id]) {\n        delete containersRef.current[id];\n        updateContainerElements();\n      }\n    }\n  }), [updateContainerElements]);\n  const handleNodeRef = React.useCallback(node => {\n    var _a;\n    if (enabled && node) {\n      nodeRef.current = node;\n      if (!focusTrapRef.current) {\n        focusTrapRef.current = createFocusTrap([], {\n          initialFocus: () => setAutoFocusRef.current && getFocusElement(node),\n          fallbackFocus: () => node,\n          returnFocusOnDeactivate: false,\n          escapeDeactivates: false,\n          clickOutsideDeactivates: false,\n          allowOutsideClick: true\n        });\n      }\n      updateContainerElements();\n      focusTrapRef.current.activate();\n    } else {\n      (_a = focusTrapRef.current) === null || _a === void 0 ? void 0 : _a.deactivate();\n      nodeRef.current = null;\n    }\n  }, [enabled, updateContainerElements]);\n  const child = React.Children.only(children);\n  if (!React.isValidElement(child)) {\n    throw new Error('Children must contain only one valid element');\n  }\n  const childRef = child.ref;\n  const ref = useForkRef(handleNodeRef, childRef);\n  return React.createElement(focusTrapContext.Provider, {\n    value: actions\n  }, React.cloneElement(child, {\n    ref\n  }));\n}\nexport function useParentFocusTrap() {\n  const actions = React.useContext(focusTrapContext);\n  const id = useUniqId();\n  return React.useMemo(() => {\n    if (!actions) {\n      return undefined;\n    }\n    return node => {\n      if (node) {\n        actions.addNode(id, node);\n      } else {\n        actions.removeNode(id);\n      }\n    };\n  }, [actions, id]);\n}\nfunction getFocusElement(root) {\n  if (!(document.activeElement instanceof HTMLElement) || !root.contains(document.activeElement)) {\n    if (!root.hasAttribute('tabIndex')) {\n      if (process.env.NODE_ENV !== 'production') {\n        // used only in dev build\n        // eslint-disable-next-line no-console\n        console.error('@gravity-ui/uikit: focus-trap content node does node accept focus.');\n      }\n      root.setAttribute('tabIndex', '-1');\n    }\n    return root;\n  }\n  return document.activeElement;\n}","map":{"version":3,"names":["React","createFocusTrap","useForkRef","useUniqId","focusTrapContext","createContext","undefined","FocusTrap","children","enabled","disableAutoFocus","autoFocus","nodeRef","useRef","setAutoFocusRef","useEffect","current","focusTrapRef","containersRef","updateContainerElements","useCallback","_a","Object","values","actions","useMemo","addNode","id","node","contains","removeNode","handleNodeRef","initialFocus","getFocusElement","fallbackFocus","returnFocusOnDeactivate","escapeDeactivates","clickOutsideDeactivates","allowOutsideClick","activate","deactivate","child","Children","only","isValidElement","Error","childRef","ref","createElement","Provider","value","cloneElement","useParentFocusTrap","useContext","root","document","activeElement","HTMLElement","hasAttribute","process","env","NODE_ENV","console","error","setAttribute"],"sources":["/Users/ilaulanov/Documents/SynopsisYard/SYfood/client/node_modules/@gravity-ui/uikit/build/esm/components/utils/FocusTrap.js"],"sourcesContent":["import React from 'react';\nimport { createFocusTrap } from 'focus-trap';\nimport { useForkRef, useUniqId } from '../../hooks';\nconst focusTrapContext = React.createContext(undefined);\nexport function FocusTrap({ children, enabled = true, disableAutoFocus, autoFocus = true, }) {\n    const nodeRef = React.useRef(null);\n    const setAutoFocusRef = React.useRef(!disableAutoFocus && autoFocus);\n    React.useEffect(() => {\n        setAutoFocusRef.current = !disableAutoFocus && autoFocus;\n    });\n    const focusTrapRef = React.useRef();\n    const containersRef = React.useRef({});\n    const updateContainerElements = React.useCallback(() => {\n        var _a;\n        (_a = focusTrapRef.current) === null || _a === void 0 ? void 0 : _a.updateContainerElements([\n            nodeRef.current,\n            ...Object.values(containersRef.current),\n        ]);\n    }, []);\n    const actions = React.useMemo(() => ({\n        addNode(id, node) {\n            var _a;\n            if (containersRef.current[id] !== node && !((_a = nodeRef.current) === null || _a === void 0 ? void 0 : _a.contains(node))) {\n                containersRef.current[id] = node;\n                updateContainerElements();\n            }\n        },\n        removeNode(id) {\n            if (containersRef.current[id]) {\n                delete containersRef.current[id];\n                updateContainerElements();\n            }\n        },\n    }), [updateContainerElements]);\n    const handleNodeRef = React.useCallback((node) => {\n        var _a;\n        if (enabled && node) {\n            nodeRef.current = node;\n            if (!focusTrapRef.current) {\n                focusTrapRef.current = createFocusTrap([], {\n                    initialFocus: () => setAutoFocusRef.current && getFocusElement(node),\n                    fallbackFocus: () => node,\n                    returnFocusOnDeactivate: false,\n                    escapeDeactivates: false,\n                    clickOutsideDeactivates: false,\n                    allowOutsideClick: true,\n                });\n            }\n            updateContainerElements();\n            focusTrapRef.current.activate();\n        }\n        else {\n            (_a = focusTrapRef.current) === null || _a === void 0 ? void 0 : _a.deactivate();\n            nodeRef.current = null;\n        }\n    }, [enabled, updateContainerElements]);\n    const child = React.Children.only(children);\n    if (!React.isValidElement(child)) {\n        throw new Error('Children must contain only one valid element');\n    }\n    const childRef = child.ref;\n    const ref = useForkRef(handleNodeRef, childRef);\n    return (React.createElement(focusTrapContext.Provider, { value: actions }, React.cloneElement(child, { ref })));\n}\nexport function useParentFocusTrap() {\n    const actions = React.useContext(focusTrapContext);\n    const id = useUniqId();\n    return React.useMemo(() => {\n        if (!actions) {\n            return undefined;\n        }\n        return (node) => {\n            if (node) {\n                actions.addNode(id, node);\n            }\n            else {\n                actions.removeNode(id);\n            }\n        };\n    }, [actions, id]);\n}\nfunction getFocusElement(root) {\n    if (!(document.activeElement instanceof HTMLElement) ||\n        !root.contains(document.activeElement)) {\n        if (!root.hasAttribute('tabIndex')) {\n            if (process.env.NODE_ENV !== 'production') {\n                // used only in dev build\n                // eslint-disable-next-line no-console\n                console.error('@gravity-ui/uikit: focus-trap content node does node accept focus.');\n            }\n            root.setAttribute('tabIndex', '-1');\n        }\n        return root;\n    }\n    return document.activeElement;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}